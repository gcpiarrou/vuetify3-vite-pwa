import{Q as L,R as T,o as y,E as R,j as g,w as p,S as x,T as I,U as V,h as O,A as j,M as B,W as $,v as P,X as C}from"./vendor.b3afb12d.js";import{_ as M}from"./plugin-vue_export-helper.21dcd24c.js";try{self["workbox:window:6.4.2"]&&_()}catch{}function b(e,r){return new Promise(function(t){var i=new MessageChannel;i.port1.onmessage=function(l){t(l.data)},e.postMessage(r,[i.port2])})}function G(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function U(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}function K(e,r){var t;if(typeof Symbol=="undefined"||e[Symbol.iterator]==null){if(Array.isArray(e)||(t=function(l,v){if(l){if(typeof l=="string")return U(l,v);var s=Object.prototype.toString.call(l).slice(8,-1);return s==="Object"&&l.constructor&&(s=l.constructor.name),s==="Map"||s==="Set"?Array.from(l):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?U(l,v):void 0}}(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(t=e[Symbol.iterator]()).next.bind(t)}try{self["workbox:core:6.4.2"]&&_()}catch{}var W=function(){var e=this;this.promise=new Promise(function(r,t){e.resolve=r,e.reject=t})};function E(e,r){var t=location.href;return new URL(e,t).href===new URL(r,t).href}var m=function(e,r){this.type=e,Object.assign(this,r)};function w(e,r,t){return t?r?r(e):e:(e&&e.then||(e=Promise.resolve(e)),r?e.then(r):e)}function D(){}var Q={type:"SKIP_WAITING"};function A(e,r){if(!r)return e&&e.then?e.then(D):Promise.resolve()}var X=function(e){var r,t;function i(u,d){var n,o;return d===void 0&&(d={}),(n=e.call(this)||this).nn={},n.tn=0,n.rn=new W,n.en=new W,n.on=new W,n.un=0,n.an=new Set,n.cn=function(){var c=n.fn,a=c.installing;n.tn>0||!E(a.scriptURL,n.sn.toString())||performance.now()>n.un+6e4?(n.vn=a,c.removeEventListener("updatefound",n.cn)):(n.hn=a,n.an.add(a),n.rn.resolve(a)),++n.tn,a.addEventListener("statechange",n.ln)},n.ln=function(c){var a=n.fn,f=c.target,h=f.state,S=f===n.vn,k={sw:f,isExternal:S,originalEvent:c};!S&&n.mn&&(k.isUpdate=!0),n.dispatchEvent(new m(h,k)),h==="installed"?n.wn=self.setTimeout(function(){h==="installed"&&a.waiting===f&&n.dispatchEvent(new m("waiting",k))},200):h==="activating"&&(clearTimeout(n.wn),S||n.en.resolve(f))},n.dn=function(c){var a=n.hn,f=a!==navigator.serviceWorker.controller;n.dispatchEvent(new m("controlling",{isExternal:f,originalEvent:c,sw:a,isUpdate:n.mn})),f||n.on.resolve(a)},n.gn=(o=function(c){var a=c.data,f=c.ports,h=c.source;return w(n.getSW(),function(){n.an.has(h)&&n.dispatchEvent(new m("message",{data:a,originalEvent:c,ports:f,sw:h}))})},function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];try{return Promise.resolve(o.apply(this,c))}catch(f){return Promise.reject(f)}}),n.sn=u,n.nn=d,navigator.serviceWorker.addEventListener("message",n.gn),n}t=e,(r=i).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t;var l,v,s=i.prototype;return s.register=function(u){var d=(u===void 0?{}:u).immediate,n=d!==void 0&&d;try{var o=this;return function(c,a){var f=c();return f&&f.then?f.then(a):a(f)}(function(){if(!n&&document.readyState!=="complete")return A(new Promise(function(c){return window.addEventListener("load",c)}))},function(){return o.mn=Boolean(navigator.serviceWorker.controller),o.yn=o.pn(),w(o.bn(),function(c){o.fn=c,o.yn&&(o.hn=o.yn,o.en.resolve(o.yn),o.on.resolve(o.yn),o.yn.addEventListener("statechange",o.ln,{once:!0}));var a=o.fn.waiting;return a&&E(a.scriptURL,o.sn.toString())&&(o.hn=a,Promise.resolve().then(function(){o.dispatchEvent(new m("waiting",{sw:a,wasWaitingBeforeRegister:!0}))}).then(function(){})),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.dn),o.fn})})}catch(c){return Promise.reject(c)}},s.update=function(){try{return this.fn?A(this.fn.update()):void 0}catch(u){return Promise.reject(u)}},s.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},s.messageSW=function(u){try{return w(this.getSW(),function(d){return b(d,u)})}catch(d){return Promise.reject(d)}},s.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&b(this.fn.waiting,Q)},s.pn=function(){var u=navigator.serviceWorker.controller;return u&&E(u.scriptURL,this.sn.toString())?u:void 0},s.bn=function(){try{var u=this;return function(d,n){try{var o=d()}catch(c){return n(c)}return o&&o.then?o.then(void 0,n):o}(function(){return w(navigator.serviceWorker.register(u.sn,u.nn),function(d){return u.un=performance.now(),d})},function(d){throw d})}catch(d){return Promise.reject(d)}},l=i,(v=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&G(l.prototype,v),i}(function(){function e(){this.Pn=new Map}var r=e.prototype;return r.addEventListener=function(t,i){this.Sn(t).add(i)},r.removeEventListener=function(t,i){this.Sn(t).delete(i)},r.dispatchEvent=function(t){t.target=this;for(var i,l=K(this.Sn(t.type));!(i=l()).done;)(0,i.value)(t)},r.Sn=function(t){return this.Pn.has(t)||this.Pn.set(t,new Set),this.Pn.get(t)},e}());function q(e={}){const{immediate:r=!1,onNeedRefresh:t,onOfflineReady:i,onRegistered:l,onRegisterError:v}=e;let s,u;const d=async(n=!0)=>{n&&(s==null||s.addEventListener("controlling",o=>{o.isUpdate&&window.location.reload()})),u&&u.waiting&&await b(u.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){s=new X("./sw.js",{scope:"./",type:"classic"}),s.addEventListener("activated",n=>{n.isUpdate||i==null||i()});{const n=()=>{t==null||t()};s.addEventListener("waiting",n),s.addEventListener("externalwaiting",n)}s.register({immediate:r}).then(n=>{u=n,l==null||l(n)}).catch(n=>{v==null||v(n)})}return d}function N(e={}){const{immediate:r=!0,onNeedRefresh:t,onOfflineReady:i,onRegistered:l,onRegisterError:v}=e,s=L(!1),u=L(!1);return{updateServiceWorker:q({immediate:r,onNeedRefresh(){s.value=!0,t==null||t()},onOfflineReady(){u.value=!0,i==null||i()},onRegistered:l,onRegisterError:v}),offlineReady:u,needRefresh:s}}const{updateServiceWorker:z}=N(),F=T({name:"ReloadPWA",setup(){const{offlineReady:e,needRefresh:r,updateServiceWorker:t}=N();return{offlineReady:e,needRefresh:r,updateServiceWorker:t,close:async()=>{e.value=!1,r.value=!1}}},methods:{async close(){this.offlineReady.value=!1,this.needRefresh.value=!1},async updateServiceWorker(){await z()}}}),H={class:"text-center"},J={key:0},Y={key:1},Z=C("p",null,"New version available",-1),ee=P(),ne=C("p",null,"Touch Update to upgrade the software",-1),te=[Z,ee,ne],re=P("Update"),oe=P("Close");function ie(e,r,t,i,l,v){return y(),R("div",H,[g($,{"model-value":e.offlineReady||e.needRefresh,style:{"max-width":"30em"}},{default:p(()=>[g(x,null,{default:p(()=>[g(I,null,{default:p(()=>[e.offlineReady?(y(),R("h3",J," The app is ready to work offline.")):(y(),R("h3",Y,te))]),_:1}),g(V,{class:"flex-column"},{default:p(()=>[e.needRefresh?(y(),O(j,{key:0,onClick:r[0]||(r[0]=s=>e.updateServiceWorker()),color:"success",class:"my-2"},{default:p(()=>[re]),_:1})):B("",!0),g(j,{onClick:e.close,class:"my-2"},{default:p(()=>[oe]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model-value"])])}var ce=M(F,[["render",ie]]);export{ce as default};
